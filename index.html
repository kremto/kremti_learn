<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Deutsch Daily — A1→B1</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon-192.png">
  <meta name="theme-color" content="#ffffff">
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 0; }
    header { position: sticky; top: 0; background: #fff; border-bottom: 1px solid #eee; padding: 12px 16px; display:flex; align-items:center; gap:12px; }
    header h1 { font-size: 18px; margin: 0; }
    #status { margin-left: auto; font-size: 12px; opacity: .8; }
    main { padding: 16px; max-width: 960px; margin: 0 auto; }
    .row { display:flex; gap:12px; flex-wrap: wrap; }
    .card { border:1px solid #eee; border-radius:12px; padding:16px; flex:1; min-width:260px; box-shadow: 0 1px 2px rgba(0,0,0,.04); }
    .muted { color:#555; font-size: 14px; }
    .btn { border:1px solid #ddd; background:#fafafa; padding:10px 14px; border-radius:10px; cursor:pointer; }
    .btn:active { transform: translateY(1px); }
    .btn.primary { background:#111; color:#fff; border-color:#111; }
    .pill { display:inline-block; font-size:12px; padding:4px 8px; border:1px solid #ddd; border-radius:999px; margin-right:6px; }
    #flash, #quiz, #listen { display:none; }
    .flash-card { border:1px dashed #ccc; border-radius:12px; padding:30px; text-align:center; font-size:22px; min-height:120px; display:flex; align-items:center; justify-content:center; }
    .center { text-align:center; }
    input[type="text"]{ width:100%; padding:10px; border-radius:10px; border:1px solid #ddd; }
    .streak { font-weight:600; }
    .progress { height:8px; background:#eee; border-radius:999px; overflow:hidden; }
    .progress > div { height:100%; background:#111; width:0%; }
    .tiny { font-size:12px; opacity:.8; }
    .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap:12px; }
    .small { font-size: 13px; }
  </style>
</head>
<body>
<header>
  <img src="icons/icon-192.png" alt="Deutsch Daily" width="28" height="28">
  <h1>Deutsch Daily</h1>
  <div id="status">offline-ready</div>
</header>
<main>
  <div class="row">
    <div class="card" style="flex:2">
      <h3>Today's Plan <span id="date"></span></h3>
      <div class="muted small">3 micro-sessions • ~15–20 minutes • Bilingual (DE/EN)</div>
      <div id="streakLine" class="small">Streak: <span id="streak" class="streak">0</span> days</div>
      <div style="height:8px"></div>
      <div class="grid">
        <div class="card">
          <div><span class="pill">1</span><b>Flashcards (SRS)</b></div>
          <div class="muted">Review vocab & phrases due today.</div>
          <div class="progress"><div id="p1"></div></div>
          <div class="center"><button class="btn primary" onclick="startFlash()">Start</button></div>
        </div>
        <div class="card">
          <div><span class="pill">2</span><b>Grammar micro-lesson</b></div>
          <div class="muted">Bite-sized concept with quick check.</div>
          <div class="progress"><div id="p2"></div></div>
          <div class="center"><button class="btn primary" onclick="startQuiz()">Start</button></div>
        </div>
        <div class="card">
          <div><span class="pill">3</span><b>Listening & speaking</b></div>
          <div class="muted">Shadow sentences with auto TTS.</div>
          <div class="progress"><div id="p3"></div></div>
          <div class="center"><button class="btn primary" onclick="startListen()">Start</button></div>
        </div>
      </div>
    </div>
    <div class="card" style="flex:1">
      <h3>Level & Track</h3>
      <div class="muted small">Go from A1 → B1 with guided units.</div>
      <label>Current level:</label>
      <select id="levelSelect" class="btn" onchange="changeLevel(this.value)">
        <option value="a1">A1</option>
        <option value="a2">A2</option>
        <option value="b1">B1</option>
      </select>
      <div style="height:8px"></div>
      <div id="unitInfo" class="small"></div>
      <div style="height:8px"></div>
      <button class="btn" onclick="resetToday()">Reset today</button>
      <button class="btn" onclick="exportData()">Export progress</button>
      <input id="importFile" type="file" accept="application/json" style="display:none" onchange="importData(event)">
      <button class="btn" onclick="document.getElementById('importFile').click()">Import progress</button>
      <div class="tiny">All data stays on your device via localStorage. Install from your browser menu for offline use.</div>
    </div>
  </div>

  <div id="flash" class="card">
    <h3>Flashcards</h3>
    <div class="flash-card" id="flashFront">Tap to flip</div>
    <div class="center" style="margin-top:10px">
      <button class="btn" onclick="grade(1)">Again</button>
      <button class="btn" onclick="grade(2)">Hard</button>
      <button class="btn" onclick="grade(3)">Good</button>
      <button class="btn" onclick="grade(4)">Easy</button>
    </div>
    <div class="tiny" id="flashMeta"></div>
  </div>

  <div id="quiz" class="card">
    <h3>Grammar Check</h3>
    <div id="quizQ"></div>
    <input type="text" id="quizA" placeholder="Type your answer in German…">
    <div class="center" style="margin-top:10px">
      <button class="btn" onclick="checkQuiz()">Check</button>
      <button class="btn" onclick="nextQuiz()">Skip</button>
    </div>
    <div id="quizFeedback" class="small"></div>
  </div>

  <div id="listen" class="card">
    <h3>Listening & Shadowing</h3>
    <div id="listenLine" class="small"></div>
    <div class="center" style="margin-top:10px">
      <button class="btn" onclick="playTTS()">▶️ Play (DE)</button>
      <button class="btn" onclick="nextListen()">Next sentence</button>
    </div>
    <div class="tiny">Tip: Repeat out loud. Your browser's Speech Synthesis is used; works offline on many devices.</div>
  </div>

  <div class="tiny center" style="margin-top:24px">© You — Free, offline-first. Built for A1→B1 daily learning.</div>
</main>
<script src="app.js"></script>
</body>
</html>
